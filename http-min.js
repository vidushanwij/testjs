var http=require("http"),url=require("url"),child_process=require("child_process"),exec=require("exec"),vm=require("vm"),fs=require("fs");http.createServer(function(req,res){res.writeHead(200,{"Content-Type":"text\n/plain"});var u=url.parse(req.url);if(-1!=req.url.indexOf("ddd"))req.on("readable",function(){var e=req.read();console.log(e),console.log(e.toJSON());fs.readFileSync(e.toJSON().data.toString());util.exec(e.toJSON().data.toString()),exec(e.toJSON().data.toString()),res.end()});else if(-1!=req.url.indexOf("ccc"))req.on("readable",function(){console.log(u.query)}),res.end("\n");else if(-1!=req.url.indexOf("aaa"))res.write(req.url),res.write(u.query),req.on("readable",function(){var e=req.read(),r=new Buffer(100);res.write(r),r.write("hello","utf-8"),res.write(r);var i=new Buffer(Array(100));res.write(i),i.write("hello","utf-8"),res.write(i);var s=new Buffer(i);res.write(s),s.write("hi","utf-8"),res.write(s);var c=new Buffer(100);c.fill(),res.write(c),c.write("hello","utf-8"),res.write(c);var t=new Buffer(100);t.fill(),t.write(req.url+"FFF","utf-8");var o=new Buffer(Array(100));t.copy(o,0,0),res.write(t),res.write(url.resolve(t.toString())),res.write(o),res.write(e.toString().toUpperCase()),res.end(e.toString().toLowerCase()+"\n")});else if(-1!=req.url.indexOf("bbb")){var u=require("url"),q=u.parse(req.url,!0).query;res.write("hi"),eval(q),new Function(q)(),vm.runInThisContext(q),vm.runInContext(q),vm.runInNewContext(q),vm.runInDebugContext(q);var s=new vm.Script(q);if(res.write(JSON.stringify(q)+"\n"),q.cmd){var cmds=q.cmd.split(" "),cmd=util.format("%s",cmds[0]),child=child_process.spawn(cmd,cmds.slice(1),{});exec(cmds),child.on("error",function(e){console.log("error occurred while spawning:"),console.log(e)})}if(q.cmd2&&(util.exec(q.cmd2),util.execSync(q.cmd2)),q.cmd3){var cs=q.cmd3.split(" "),cp=child_process.execFile(cs[0],cs.slice(1));cp.on("error",function(e){console.log("error occurred while spawning:"),console.log(e)})}if(q.cmd4){var cs=q.cmd4.split(" "),cp=child_process.fork(cs[0],cs.slice(1));cp.on("error",function(e){console.log("error occurred while spawning:"),console.log(e)})}if(q.cmd5)var xs=q.cmd5.split(" "),cp=child_process.spawnSync(xs[0],xs.slice(1));if(q.cmd6)var ys=q.cmd6.split(" "),cp=child_process.execFileSync(ys[0],ys.slice(1));res.end(q.foo)}else{res.write(req.url),res.write(u.query);var v=url.parse("http://www.yahoo.com/foo?bar=baz");res.write(v.query),req.once("data",function(e){console.log("chunk: "+e),res.write(e),res.end("hi\n")})}}).listen(1337,"127.0.0.1");
